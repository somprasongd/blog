---
title: 'Golang Part 2: Advanced concepts in Go'
date: '2022-01-08'
lastmod: '2022-10-14'
tags: ['go']
draft: false
summary: 'Advanced concepts ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏à‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Library ‡∏ï‡πà‡∏≤‡∏á‡πÜ'
# images: ['/api/social-image/blog/go/go-advanced-concepts.jpg']
---

# Advanced concepts in Go

‡πÉ‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Advanced concepts ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏à‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Library ‡∏ï‡πà‡∏≤‡∏á‡πÜ

## Advanced Functions

### Variadic Function

‡∏Ñ‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô `(p ...T)`

```go
package main

import "fmt"

func main() {
	y := sum(1, 2, 3, 4, 5)

	fmt.Println(y)
}

func sum(x ...int) int {
	s := 0
	for _, v := range x {
		s += v
	}
	return s
}
```

<aside>
üí° ‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á slice ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ spread operator ‡∏Ñ‡∏∑‡∏≠ `sum(slice...)`

</aside>

### First Class Function

‡∏Ñ‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô field ‡πÉ‡∏ô `struct` ‡∏Å‡πá‡πÑ‡∏î‡πâ

```go
// variable
var add = func(a, b int) int {
	return a + b
}
fmt.Println(add(1, 2))

// field
m := Math{add: add}
fmt.Println(m.add(1, 2))

// ‡πÉ‡∏ô struct ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
type Math struct {
	add func(int, int) int
}
```

### Higher Order Function

‡∏°‡∏µ 2 ‡πÅ‡∏ö‡∏ö ‡∏Ñ‡∏∑‡∏≠

1. **Function as Parameters** ‡∏Ñ‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏î‡πÜ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏î‡πâ

```go
package advfunc

import "fmt"

func LearnHOFParam() {
// ‡∏™‡πà‡∏á‡πÑ‡∏õ anonymous function ‡πÑ‡∏õ
s := hofGreeting(func() string {
return "Ball"
})

fmt.Println(s)
}

// function ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö parameter ‡πÄ‡∏õ‡πá‡∏ô anonymous function ‡∏ó‡∏µ‡πà return string
func hofGreeting(nameFn func() string) string {
return fmt.Sprintf("Hello %s", nameFn())
}
```

‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô type ‡∏Ç‡∏≠‡∏á function ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏ó‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

```go
package advfunc

import "fmt"

func LearnHOFParam() {
  // ‡∏™‡πà‡∏á‡πÑ‡∏õ anonymous function ‡πÑ‡∏õ
	s := hofGreeting(func() string {
		return "Ball"
	})

	fmt.Println(s)
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á type ‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô function ‡∏ó‡∏µ‡πà return string
type nameFunc func() string

// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏±‡∏ö parameter ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô type ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤
func hofGreeting(nameFn nameFunc) string {
	return fmt.Sprintf("Hello %s", nameFn())
}
```

‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á function ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (First Class Function) ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏Å‡πá‡πÑ‡∏î‡πâ

```go
package advfunc

import "fmt"

func LearnHOFParam() {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏ö‡∏ö first class function
	nameFn := func() string {
		return "Ball"
	}
  // ‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÑ‡∏õ‡πÅ‡∏ó‡∏ô
	s := hofGreeting(nameFn)

	fmt.Println(s)
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á type ‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô function ‡∏ó‡∏µ‡πà return string
type nameFunc func() string

// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏±‡∏ö parameter ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô type ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤
func hofGreeting(nameFn nameFunc) string {
	return fmt.Sprintf("Hello %s", nameFn())
}
```

2. **Function as Return** ‡∏Ñ‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà `return` ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏î‡πâ

```go
package advfunc

import "fmt"

func LearnHOFReturn() {
	s := hofGreeting(newNameFunc("Ball"))

	fmt.Println(s)
}

func newNameFunc(name string) nameFunc {
	// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏ö‡∏ö first class function
	nameFn := func() string {
		return name // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤‡πÅ‡∏ó‡∏ô
	}

	return nameFn
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á type ‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô function ‡∏ó‡∏µ‡πà return string
type nameFunc func() string

// ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏±‡∏ö parameter ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô type ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏°‡∏≤
func hofGreeting(nameFn nameFunc) string {
	return fmt.Sprintf("Hello %s", nameFn())
}
```

### Closesure Function

‡∏Ñ‡∏∑‡∏≠ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà return ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà return ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏à‡∏≤‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏î‡πâ‡∏ß‡∏¢

```go
package advfunc

import "fmt"

func LearnClosure() {
	counterFn := newCounterFunc()
	fmt.Println(counterFn())
	fmt.Println(counterFn())
	fmt.Println(counterFn())
}

func newCounterFunc() func() int {
	var i int

	return func() int {
		i++
		return i
	}
}

// output
// 1
// 2
// 3
```

## Type Assertions

‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á interface ‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÜ ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏≠‡∏≤ interface ‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏°‡∏≤‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ï‡∏£‡∏á‡πÜ ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• type ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏à‡∏∞‡∏ó‡∏≥‡∏ï‡∏£‡∏á‡πÜ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô `static type` ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Assertions ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `.(T)`

```go
var i interface{}
i = "text"

var s string
// ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
s = i

// ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ assertion ‡πÉ‡∏ä‡πâ .(type)
s = i.(string)
```

‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∑‡∏≠ ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥ assertion ‡∏ú‡∏¥‡∏î type ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î panic ‡∏Ç‡∏∂‡πâ‡∏ô ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô

```go
var i interface{}
i = "text"

var s string
if v, ok := i.(string); ok {
  s = v
}
```

‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô type ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢ type ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤ switch case ‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ

```go
func whichType(i interface{}) {
  switch v := i.(type) {
    case string:
      fmt.Printf("this is a string %v\n", v)
    case int:
			fmt.Printf("this is a integer %v\n", v)
    default:
      fmt.Println("don't know type")
  }
```

## Defer

‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà `defer` ‡πÑ‡∏ß‡πâ‡∏´‡∏ô‡πâ‡∏≤ statement ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ statment ‡∏ô‡∏±‡πâ‡∏ô ‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ execute ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏ó‡∏≥‡∏ï‡∏≠‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏à‡∏∞ return

```go
package main

import "fmt"

func main() {
	defer fmt.Println("world")

	fmt.Println("hello")
}

// output
hello
world
```

‡πÅ‡∏ï‡πà‡∏Ñ‡πà‡∏≤ `arguments` ‡∏ô‡∏±‡πà‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô

```go
package main

import "fmt"

func main() {
	fmt.Println("counting")

	for i := 0; i < 3; i++ {
		defer fmt.Println(i)
    // ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
		// defer fmt.Println(0)
		// defer fmt.Println(1)
		// defer fmt.Println(2)
	}

	fmt.Println("done")
}

// output
// counting
// done
// 2
// 1
// 0
```

## Goroutine

Goroutine ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö concurrent ‡πÉ‡∏ô‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á lightweight thread ‡πÇ‡∏î‡∏¢ Go ‡∏à‡∏∞‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á layer ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏≠‡∏µ‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà thread ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏à‡∏∂‡∏á‡πÉ‡∏ä‡πâ memory ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤

‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Goroutine ‡πÅ‡∏Ñ‡πà‡πÉ‡∏™‡πà keyword ‡∏ß‡πà‡∏≤ `go` ‡∏´‡∏ô‡πâ‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ goroutine ‡πÄ‡∏•‡∏¢

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ function ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ô‡∏≤‡∏ô‡πÜ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

```go:main.go
package goroutine

import (
	"fmt"
	"time"
)

func LearnGR() {
	start := time.Now()
	doLongTask(1)
	doLongTask(2)
	doLongTask(3)
	time.Sleep(120 * time.Millisecond)
	fmt.Printf("Done in %v\n", time.Since(start))
}

func doLongTask(taskId int) {
	time.Sleep(100 * time.Millisecond)
	fmt.Printf("task id: %d done.\n", taskId)
}

// Output
// task id: 1 done.
// task id: 2 done.
// task id: 3 done.
// Done in 425.555828ms
```

‡πÄ‡∏≠‡∏≤ goroutine ‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢

```go
package goroutine

import (
	"fmt"
	"time"
)

func LearnGR() {
	start := time.Now()
	go doLongTask(1)
	go doLongTask(2)
	go doLongTask(3)
	time.Sleep(120 * time.Millisecond)
	fmt.Printf("Done in %v\n", time.Since(start))
}

func doLongTask(taskId int) {
	time.Sleep(100 * time.Millisecond)
	fmt.Printf("task id: %d done.\n", taskId)
}

// Output
// task id: 3 done.
// task id: 2 done.
// task id: 1 done.
// Done in 120.666304ms
```

### Waitgroup

‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Goroutine ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡∏Å main thread ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ goroutine ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏à‡∏∞‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢

‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà `time.Sleep(120 * time.Millisecond)` ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡πÉ‡∏´‡πâ Goroutine ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏ö‡∏Å‡πà‡∏≠‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡πÉ‡∏´‡πâ goroutine ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `sync.WaitGroup` ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ó‡∏ô

```go
package goroutine

import (
	"fmt"
	"sync"
	"time"
)

func LearnWG() {
	start := time.Now()

	wg := &sync.WaitGroup{}
	// ‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
	wg.Add(3)

	go doLongTaskWG(1, wg)
	go doLongTaskWG(2, wg)
	go doLongTaskWG(3, wg)
	// ‡∏´‡∏¢‡∏∏‡∏î‡∏Ñ‡∏≠‡∏¢‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
	wg.Wait()

	fmt.Printf("Done in %v\n", time.Since(start))
}

func doLongTaskWG(taskId int, wg *sync.WaitGroup) {
	time.Sleep(100 * time.Millisecond)
	fmt.Printf("task id: %d done.\n", taskId)
  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤ done
	wg.Done()
}
```

### Race Condition

Race Condition ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà goroutine ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏ï‡∏±‡∏ß ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `mux.Lock()` ‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πá‡∏™‡∏±‡πà‡∏á `mux.Unlock()`

```go
package goroutine

import (
	"fmt"
	"sync"
)

var i int
var mux sync.Mutex

func LearnRC()  {
	go func() {
		for {
			fmt.Println(read())
		}
	}()

	for i := 0; i < 10; i++ {
		write(i)
	}
}

func write(n int) {
	mux.Lock()
	i = n
	mux.Unlock()
}

func read() int {
	mux.Lock()
	// unlock ‡∏´‡∏•‡∏±‡∏á return
	defer mux.Unlock()
	return i
}
```

### Channel

Channel ‡∏Ñ‡∏∑‡∏≠ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà goroutine ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á goroutine ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ goroutine ‡∏Å‡∏±‡∏ö main thread

Channel ‡∏°‡∏µ 2 ‡πÅ‡∏ö‡∏ö

- **Unbuffered** ‡πÄ‡∏õ‡πá‡∏ô guaranteed synchronization ‡∏Ñ‡∏∑‡∏≠ ‡∏ñ‡πâ‡∏≤‡∏ù‡∏±‡πà‡∏á‡∏™‡πà‡∏á ‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏£‡∏±‡∏ö ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ù‡∏±‡πà‡∏á‡∏™‡πà‡∏á ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `make(chan string)`
- **Buffered** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `make(chan string, 5)` ‡∏ã‡∏∂‡πà‡∏á 5 ‡∏Ñ‡∏∑‡∏≠ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô buffered ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡∏ù‡∏±‡πà‡∏á‡∏™‡πà‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô buffered ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏°‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏à‡∏ô‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô

‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Å‡πá‡∏°‡∏µ 2 ‡πÅ‡∏ö‡∏ö

- **2-way Channel** ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ
- **1-way Channel** ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Channel

```go
package goroutine

import "fmt"

func LearnChan() {
	ch := make(chan int)

	go fibo(ch)

	for i := 0; i < 10; i++ {
		fmt.Println(<-ch)
	}
}

func fibo(ch chan int) {
	a, b := 0, 1

	for{
		ch <- a
		a, b = b, a+b
	}
}
```

### Select Statement

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å channel ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÇ‡∏î‡∏ô block ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 channel ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å channel ‡πÉ‡∏î channel ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏™‡πà‡∏á‡∏°‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏¢ ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ select statement ‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢

```go
package goroutine

import "fmt"

func LearnChanWithSelect() {
	ch := make(chan int)
	qCh := make(chan struct{})

	go fibo2(ch, qCh)

	for i := 0; i < 10; i++ {
		fmt.Println(<-ch)
	}
  // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
	qCh <- struct{}{}

	// ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
	<-qCh
	fmt.Println("Done")
}

func fibo2(ch chan int, qCh chan struct{}) {
	a, b := 0, 1

	for{
		select{
		case ch <- a:
		a, b = b, a+b
		case <-qCh:
			// ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÅ‡∏•‡πâ‡∏ß
			qCh <- struct{}{}
			return
		}

	}
}
```

<aside>
  üí° ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ channel ‡πÑ‡∏ß‡πâ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `make(chan struct{})` ‡∏´‡∏£‡∏∑‡∏≠ `make(chan
  [0]func)` ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô memory
</aside>

<aside>
  üí° channel ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á close ‡πÄ‡∏£‡∏≤‡∏à‡∏∞ close ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á signal ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏ñ‡πâ‡∏≤‡πÑ‡∏õ
  close ‡∏ã‡πâ‡∏≥ ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î panic ‡πÑ‡∏î‡πâ
</aside>

## Work with JSON

‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ standard library ‡∏ä‡∏∑‡πà‡∏≠ [encoding/json](https://golang.org/pkg/encoding/json/) ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏∞ type ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Marshal ‡∏ã‡∏∂‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ API ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÅ‡∏õ‡∏•‡∏á struct ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á JSON ‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô map ‡∏´‡∏£‡∏∑‡∏≠ struct ‡πÄ‡∏£‡∏µ‡∏Å‡∏¢‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£ Unmarshal

### JSON Marshal map

```go
package main

import (
	"encoding/json"
	"fmt"
	"time"
)

func main() {
	m := map[string]interface{}{
		"Name": "Ball",
		"Age": 37,
		"Active": true,
		"lastLoginAt": time.Now(),
	}
	u, err := json.Marshal(m)
	if err != nil {
		panic(err)
	}
	fmt.Println(string(u)) // {"Name":"Ball","Age":37,"Active":true,"lastLoginAt":"2022-01-08T09:50:03.4819564+07:00"}
}
```

### JSON Marshal Struct

```go
package main

import (
	"encoding/json"
	"fmt"
	"time"
)

type User struct {
	Name        string
	Age         int
	Active      bool
	lastLoginAt time.Time
}

func main() {
	u, err := json.Marshal(User{Name: "Ball", Age: 35, Active: true, lastLoginAt: time.Now()})
	if err != nil {
		panic(err)
	}
	fmt.Println(string(u)) // {"Name":"Ball","Age":35,"Active":true}
}
```

<aside>
üí° ‡πÅ‡∏ï‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ struct ‡∏ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ field ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å field ‡∏ô‡∏±‡πâ‡∏ô ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏°‡∏≤‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON ‡πÉ‡∏´‡πâ

</aside>

### JSON Marshal Struct with JSON Tags

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ field ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á field ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ JSON tags `json:""`

```go
package main

import (
	"encoding/json"
	"fmt"
	"time"
)

type User struct {
	Name        string `json:"full_name"`
	Age         int    `json:"age,omitempty"`
	Active      bool   `json:"-"`
	lastLoginAt time.Time
}

func main() {
	u, err := json.Marshal(User{Name: "Ball", Age: 35, Active: true, lastLoginAt: time.Now()})
	if err != nil {
		panic(err)
	}
	fmt.Println(string(u)) // {"full_name":"Ball","age":35}

	u, err = json.Marshal(User{Name: "Somprasong Damyos", Age: 0, Active: true, lastLoginAt: time.Now()})
	if err != nil {
		panic(err)
	}
	fmt.Println(string(u)) // {"full_name":"Somprasong Damyos"}
}
```

<aside>
üí° ‡πÉ‡∏ä‡πâ ``json:"field_name"`` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô JSON field

‡πÉ‡∏ä‡πâ `json:"field_name,omitempty"` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô zero-value ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON

‡πÉ‡∏ä‡πâ `json:"-"` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å JSON field

</aside>

### JSON Unmarshal to map

```go:main.go
func main() {
	var m map[string]interface{}
	str := `{"Active":true,"Age":37,"Name":"Ball","lastLoginAt":"2022-10-14T09:50:03.4819564+07:00"}`
	b := []byte(str)
	if err := json.Unmarshal(b, &m); err != nil {
		panic(err)
	}
	fmt.Printf("%#v", m)
	// {"Active":true, "Age":37, "Name":"Ball", "lastLoginAt":"2022-10-14T09:50:03.4819564+07:00"}
}
```

### JSON Unmarshal to struct

```go:main.go
func main() {
	u := User{}
	str := `{"Active":true,"Age":37,"Name":"Ball","lastLoginAt":"2022-10-14T09:50:03.4819564+07:00"}`
	b := []byte(str)
	if err := json.Unmarshal(b, &u); err != nil {
		panic(err)
	}
	fmt.Printf("%#v\n", u)
	fmt.Println(u.lastLoginAt)
}

// Output
main.User{Name:"", Age:37, Active:false, lastLoginAt:time.Time{wall:0x0, ext:0, loc:(*time.Location)(nil)}}
0001-01-01 00:00:00 +0000 UTC
```

<aside>üí° ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ field ‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ map ‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ</aside>
<aside>
  üí° ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö tag json ‡∏ä‡∏∑‡πà‡∏≠ key ‡πÉ‡∏ô JSON ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô tag json ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö case insensitive
</aside>
<aside>‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ `json:"-"` ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ map ‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ field ‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏î‡πâ‡∏ß‡∏¢</aside>

## Go environment variables

‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ configuration ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏° process ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô‡∏ï‡∏≠‡∏ô dev ‡∏Å‡πá‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Å‡πá‡πÉ‡∏ä‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ environment variables ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

### Go os.Getenv

`Getenv` ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ environment variable ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠

```go:main.go
package main

import (
	"fmt"
	"os"
)

func main() {
	key := "PORT"
	fmt.Println("Port:", os.Getenv(key)) // "3000" or "" ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ key
}
```

### Go os.LookupEnv

‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `Getenv` ‡∏Ñ‡∏∑‡∏≠ ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ key ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏õ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏°‡∏µ key ‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ key ‡∏Å‡∏±‡∏ô‡πÅ‡∏ô‡πà ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `LookupEnv` ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô

```go:main.go
package main

import (
	"fmt"
	"os"
)

func main() {
	key := "PORT"
	val, ok := os.LookupEnv(key)
	if !ok {
		fmt.Printf("%s not set\n", key)
	} else {
		fmt.Printf("%s=%s\n", key, val)
	}

	fmt.Println(GetEnvInt(key, 3000))
}

// ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ key ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ default value ‡∏°‡∏≤‡πÅ‡∏ó‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ
func GetEnv(key string, defaultVal string) string {
	val, ok := os.LookupEnv(key)
	if !ok {
		return defaultVal
	}
	return val
}

func GetEnvInt(key string, defaultVal int) int {
	val, ok := os.LookupEnv(key)
	if !ok {
		return defaultVal
	}
	v, err := strconv.Atoi(val)
	if err != nil {
		return defaultVal
	}
	return v
}

func GetEnvBool(key string, defaultVal bool) bool {
	val, ok := os.LookupEnv(key)
	if !ok {
		return defaultVal
	}
	v, err := strconv.ParseBool(val)
	if err != nil {
		return defaultVal
	}
	return v
}

```

### Go os.Setenv

‡πâ‡πÉ‡∏ä‡πâ `Setenv` ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ environment variable

```go:main.go
package main

import (
	"fmt"
	"os"
)

func main() {
	key := "PORT"

	fmt.Println("Port:", os.Getenv(key))

	os.Setenv(key, "3000")

	fmt.Println("Port:", os.Getenv(key))
}

// Out put
Port:
Port: 3000

```

### Go list environment variables

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ `Environ` ‡∏à‡∏∞‡∏Ñ‡πà‡∏≤ []string ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡πÇ‡∏î‡∏¢ string ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö key=value

```go:main.go
package main

import (
	"fmt"
	"os"
	"strings"
)

func main() {
	for _, e := range os.Environ() {
		pair := strings.SplitN(e, "=", 2)

		fmt.Printf("%s: %s\n", pair[0], pair[1])
	}
}
```

---

‡∏Å‡πá‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ Advanced concepts ‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤ Go ‡∏ã‡∏∂‡πà‡∏á‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏µ‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á ‡πÅ‡∏ï‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏≠‡∏≤‡∏†‡∏≤‡∏©‡∏≤ Go ‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á API Service ‡πÅ‡∏•‡πâ‡∏ß

‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤ Go ‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô [Test](/blog/go/golang-part3)
